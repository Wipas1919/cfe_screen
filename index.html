<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Power BI – Low Render Resolution, Scaled Up</title>
  <meta http-equiv="refresh" content="1800"> <!-- กันค้าง -->
  <style>
    html,body{margin:0;height:100%;background:#000;overflow:hidden}

    /* กำหนด “ความละเอียดเรนเดอร์จริง” ที่อยากให้เบา */
    :root{
      --tw: 1280; /* กว้างที่เรนเดอร์จริง (ปรับ: 960/1280/1366) */
      --th: 720;  /* สูงที่เรนเดอร์จริง (ปรับ: 540/720/768) */
    }

    /* กรอบเต็มจอ */
    .stage{
      position:fixed; inset:0; background:#000; overflow:hidden;
    }

    /* พื้นที่เรนเดอร์ขนาดเล็ก */
    .renderBox{
      position:absolute; top:0; left:0;
      width: calc(var(--tw) * 1px);
      height: calc(var(--th) * 1px);
      transform-origin: top left;
      /* scale จะถูกเติมด้วย JS ด้านล่าง เพื่อพอดีจอ */
    }

    iframe{
      width:100%; height:100%; border:0; background:#000;
    }
  </style>
</head>
<body>
  <div class="stage">
    <div id="box" class="renderBox">
      <iframe
        src="https://app.powerbi.com/view?r=YOUR_TOKEN&filterPaneEnabled=false&navContentPaneEnabled=false"
        title="PBI"
        scrolling="no"
        allowfullscreen>
      </iframe>
    </div>
  </div>

  <script>
    // คำนวณสเกลให้พอดีหน้าจอ (คงอัตราส่วน)
    function fit() {
      const tw = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--tw'));
      const th = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--th'));
      const sx = window.innerWidth / tw;
      const sy = window.innerHeight / th;
      const s = Math.min(sx, sy);
      const box = document.getElementById('box');
      box.style.transform = `scale(${s})`;
    }
    window.addEventListener('resize', fit);
    fit();
  </script>
</body>
</html>
